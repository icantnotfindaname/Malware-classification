from cProfile import label
from form_process import load_csv_to_array
import numpy as np
import constants
from knn import knn_with_auto_algorithm
from rf import best_random_forest
from utils import get_array_from_feather


def main():
    # knn_for_gist()
    rf_for_gist()


def rf_for_gist():
    train_x, train_y, test_x, test_y = get_need_data_for_knn()
    best_random_forest(train_x, train_y, test_x, test_y)


def knn_for_gist():
    train_x, train_y, test_x, test_y = get_need_data_for_knn()
    knn_with_auto_algorithm(train_x, train_y, test_x, test_y)


def get_need_data_for_knn():
    labels = get_labels_for_gist()
    gist = get_array_from_feather('./testres/gist.feather')
    ratio = constants.TRAINING_DATA_RATIO
    training_size = int(labels.shape[0] * ratio)
    train_x = gist[0:training_size]
    test_x = gist[training_size:gist.shape[0]]
    train_y = labels[0:training_size]
    test_y = labels[training_size:labels.shape[0]]
    return train_x, train_y, test_x, test_y


def get_labels_for_gist():
    l = load_csv_to_array('./testres/labels.csv')
    labels = []
    for item in l:
        labels.append(item[0])
    labels = np.array(labels)
    return labels


if __name__ == '__main__':
    main()
